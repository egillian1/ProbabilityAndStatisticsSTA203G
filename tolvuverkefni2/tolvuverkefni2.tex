\documentclass[12pt]{article}

\usepackage[T1]{fontenc} \usepackage[icelandic]{babel}
\usepackage{latexsym,amssymb,amsmath}
\usepackage{enumitem}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{LastPage}
\usepackage{tikz}
\usepackage{float}
\usepackage{pgfplots}
\usepackage{listings}
\usepackage{color}
\lstset{ %
  language=R,                     % the language of the code
  basicstyle=\footnotesize\ttfamily,       % the size of the fonts that are used for the code
  numbers=left,                   % where to put the line-numbers
  numberstyle=\tiny\color{gray},  % the style that is used for the line-numbers
  stepnumber=1,                   % the step between two line-numbers. If it's 1, each line
                                  % will be numbered
  numbersep=5pt,                  % how far the line-numbers are from the code
  backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  frame=single,                   % adds a frame around the code
  rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. commens (green here))
  tabsize=2,                      % sets default tabsize to 2 spaces
  captionpos=b,                   % sets the caption-position to bottom
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  title=\lstname,                 % show the filename of files included with \lstinputlisting;
                                  % also try caption instead of title
  keywordstyle=\color{blue},      % keyword style
  commentstyle=\color{green},   % comment style
  stringstyle=\color{red},      % string literal style
  escapeinside={\%*}{*)},         % if you want to add a comment within your code
  morekeywords={*,...}            % if you want to add more keywords to the set
} 


\voffset=-1.0in
\hoffset=-0.5in
\textwidth=6in
\textheight=9.0in

\begin{document}

\pagestyle{fancy}

\lhead{Egill Ian Guðmundsson}
\chead{eig20@hi.is}
\rhead{bls. \thepage ~af \pageref{LastPage}}

\newcommand{\br}{\par}
\newcommand{\substackpar}{}
\newcommand{\substackbr}{,\,}
%\usepackage{makeidx}
\newcommand{\bolddot}{{\mathbf \cdot}}
\newcommand{\C}{{\mathbb  C}}
\newcommand{\Cn}{{\mathbb  C\sp n}}
\newcommand{\crn}{{{\mathbb  C\mathbb  R^n}}}
\newcommand{\R}{{\mathbb  R}}
\newcommand{\Rn}{{\mathbb  R\sp n}}
\newcommand{\Rnn}{{\mathbb  R\sp{n\times n}}}
\newcommand{\Z}{{\mathbb  Z}}
\newcommand{\N}{{\mathbb  N}}
\renewcommand{\P}{{\mathbb  P}}
\newcommand{\Q}{{\mathbb  Q}}
\newcommand{\U}{{\mathbb  U}}
\newcommand{\D}{{\mathbb  D}}
\newcommand{\T}{{\mathbb  T}}
\newcommand{\A}{{\cal A}}
\newcommand{\E}{{\cal E}}
\newcommand{\F}{{\cal F}}
\renewcommand{\H}{{\cal H}}
\renewcommand{\L}{{\cal L}}
\newcommand{\M}{{\cal M}}
\renewcommand{\O}{{\cal O}}
\renewcommand{\S}{{\cal S}}
\newcommand{\dash}{{\sp{\prime}}}
\newcommand{\ddash}{{\sp{\prime\prime}}}
\newcommand{\tdash}{{\sp{\prime\prime\prime}}}
\newcommand{\set }[1]{{\{#1\}}}
\newcommand{\scalar}[2]{{\langle#1,#2\rangle}}
\newcommand{\arccot}{{\operatorname{arccot}}}
\newcommand{\arccoth}{{\operatorname{arccoth}}}
\newcommand{\arccosh}{{\operatorname{arccosh}}}
\newcommand{\arcsinh}{{\operatorname{arcsinh}}}
\newcommand{\arctanh}{{\operatorname{arctanh}}}
\newcommand{\Log}{{\operatorname{Log}}}
\newcommand{\Arg}{{\operatorname{Arg}}}
\newcommand{\grad}{{\operatorname{grad}}}
\newcommand{\graf}{{\operatorname{graf}}}
\renewcommand{\div}{{\operatorname{div}}}
\newcommand{\rot}{{\operatorname{rot}}}
\newcommand{\curl}{{\operatorname{curl}}}
\renewcommand{\Im}{{\operatorname{Im\, }}}
\renewcommand{\Re}{{\operatorname{Re\, }}}
\newcommand{\Res}{{\operatorname{Res}}}
\newcommand{\vp}{{\operatorname{vp}}}
\newcommand{\mynd}[1]{{{\operatorname{mynd}(#1)}}}
\newcommand{\dbar}{{{\overline\partial}}}
\newcommand{\inv}{{\operatorname{inv}}}
\newcommand{\sign}{{\operatorname{sign}}}
\newcommand{\trace}{{\operatorname{trace}}}
\newcommand{\conv}{{\operatorname{conv}}}
\newcommand{\Span}{{\operatorname{Sp}}}
\newcommand{\stig}{{\operatorname{stig}}}
\newcommand{\Exp}{{\operatorname{Exp}}}
\newcommand{\diag}{{\operatorname{diag}}}
\newcommand{\adj}{{\operatorname{adj}}}
\newcommand{\erf}{{\operatorname{erf}}}
\newcommand{\erfc}{{\operatorname{erfc}}}
\renewcommand{\ast}{{\operatorname{\text{?st}}}}
\newcommand{\Lloc}{{L_{\text{loc}}\sp 1}}
\newcommand{\boldcdot}{{\mathbb \cdot}}
%\newcommand{\Cinf0}[1]{{C_0\sp{\infty}(#1)}}
\newcommand{\supp}{{\text{supp}\, }}
\newcommand{\chsupp}{{\text{ch supp}\, }}
\newcommand{\singsupp}{{\text{sing supp}\, }}
\newcommand{\SL}[1]{{\dfrac {1}{\varrho} \bigg(-\dfrac d{dx}\bigg(p\dfrac {d#1}{dx}\bigg)+q#1\bigg)}}
\newcommand{\SLL}[1]{-\dfrac d{dx}\bigg(p\dfrac {d#1}{dx}\bigg)+q#1}
\newcommand{\Laplace}[1]{\dfrac{\partial^2 #1}{\partial x^2}+\dfrac{\partial^2 #1}{\partial y^2}}
\newcommand{\polh}[1]{{\widehat #1_{\C^n}}}
\newcommand{\tilv}{{}}

\newcommand{\sz}{\overline{z}}
\newcommand{\saf}{\overline{f}}
\newcommand{\sw}{\overline{w}}

\newcommand{\pz}{\partial_z}
\newcommand{\psz}{\partial_{\overline{z}}}
%%%

\newcommand{\Nv}{\mbox{${\bf N}$}}

\newcommand{\Bv}{\mbox{${\bf B}$}}


\newcommand{\Tv}{\mbox{${\bf T}$}}

%%%

\centerline{\bf \LARGE Líkindareikningur og Tölfræði STÆ203G}
\medskip %breyta




\centerline{\bf \Large Tölvuverkefni 2 }
\centerline{\bf Egill Ian Guðmundsson, 260693-2639}

\medskip

\textbf{Verkefni 1 } \\
Logrinn á verði hlutabréfs breytist á milli samliggjandi daga samkvæmt normaldreifingu með meðalgildi 0,00047 og staðalfráviki 0,0031. Byrjað er í stöðu sem er jöfn 0 í tímapunkti k=0. Í tímapunkti k=1 hefur logrinn á verði hlutabréfsins stokkið upp eða niður frá síðasta lograverði hlutabréfsins þar sem stærð stökksins fylgir normaldreifingu með áðurnefndum stikagildum. Stökkið í k=2 er óháð stökkinu í k=1. Svona breytist lograverðið frá einum tímapunkti til þess næsta. Gerum ráð fyrir t=245 tímapunkta (vinnudagar).

\medskip

\textbf{1.1. } Finnið hversu mikið hlutbréfið hefur stokkið að meðaltali eftir 245 daga. Notið hermun með B=4000 ítrunum og reiknið meðaltalið af stöðunni eftir 245 daga (raun- og log-skala).

\medskip

\textbf{Lausn: } Keyrum kóðann fyrir þetta verkefni og fáum eftirfarandi skilaboð á skipanalínu:

\begin{figure}[H]
\centering
\includegraphics[scale=0.85]{logproblemrun.png}
\end{figure}

Hér sést að meðaltalið af stöðunni á lograskala eftir 245 daga reiknast sem 0.114738988318759 og meðaltalið á raunskala þá 1.1215806531152.

\textbf{1.2. } Notið líkindareikning til að reikna meðalgildið á lograskala og á raunskala frá byrjunarpunkt eftir 245 stökk og berið saman við svar að ofan.

\medskip

\textbf{Lausn: } Af myndinni að ofan sést að fræðilega gildið er 0.11515 eftir 245 stökk á lograskala og er býsna nálægt gildinu sem fékkst í hermuninni (um 0.0004 skekkja). Fyrir raungildið reiknast fræðilega gildið um 0.122041731 og er einnig mjög nálægt hermigildi (einnig um 0.0004 skekkja).

\medskip

\textbf{1.3. } Finnið einnig staðalfrávik á stöðunni frá byrjunarpunkti eftir 245 stökk. Reiknið staðalfrávik af stöðunni eftir 245 daga eftir 4000 ítranir (raun- og log-skala).

\medskip

\textbf{Lausn: } Skoðum aftur myndina okkar góðu:

\begin{figure}[H]
\centering
\includegraphics[scale=0.85]{logproblemrun.png}
\end{figure}

Þar kemur fram að staðalfrávikið á lograskala reiknast um 0.048275869407 og að staðalfrávikið á raunskala sé um 1.122888370753.

\medskip

\textbf{1.4 } Notið líkindareikning til að reikna staðalfrávikið á lograskala og raunskala frá byrjunarpunkti eftir 245 stökk og berið saman við svarið í liðnum hér að ofan.

\medskip

\textbf{Lausn: } Fræðilegt staðalfrávik á lograskala hefur þá reiknast 0.04852267511175 og hermigildið þá með um 0.0002 skekkju. Fræðilegt staðalfrávik á raunskala er um 1.12336340459 og hermigildið þá með um 0.0004 skekkju.

\medskip

\textbf{1.5. } Teiknið fimm ferla af verði hlutbréfsins frá byrjunarstöðu yfir í lokastöðu eftir 245 stökk á raunskala með tíma á x-ás og verði á y-ás. Notið mismunandi liti fyrir hvern feril.

\medskip

\textbf{Lausn: } Við setjum inn 5 sem númer grafa sem við viljum fá út úr forritunu og fáum þá eftirfarandi mynd:

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{loggraph.png}
\end{figure}

\newpage

\textbf{Verkefni 2} \\
Í þessari æfingu á að herma Poissonferli með veldisdreifingu. G.r.f. að tíðni Poissonferlisins sé c=0,062 á hverja tímaeiningu og að heildarlengd bilsins sem er skoðað sé t=78 tímaeininga. fyrsti atburðurinn frá t=0 gerist á tíma $T_1$ þar sem $T_1 ~ Exp(c)$. Látum $X_1$ vera lengd bilsins frá t=0 til $X_1$ og því er $X_1 = T_1$. Næstu atburðir taka mið af fyrri atburði og reiknast eins. Almennt gildir að $T_n = \sum^n_{i=1} X_i$ og fyrir hvert i gildir að $X_i ~ Exp(c)$ ásamt því að $X_i$ er óháð $X_j$ ef i er ekki það sama og j. Til að herma Poissonferli á bilinu [0;78] þarf að herma veldisstærðir og leggja þær saman þangaið til að summa þeirra er stærri en 78, þannig að ef $T_m < 78$ og $T_{m}+1 > 78$ þá er fjöldi atburða m.

\medskip

\textbf{2.1. } Hver er væntanlegur fjöldi atburða sem á sér stað á bilinu [0;78] skv. reglum um Poissonferli? Notið hermun með 4000 ítrunum og reiknið meðaltalið af fjölda atburða sem eiga sér stað á bilinu. Hvernig ber fræðilega væntigildinu saman við reiknaða meðaltalið sem er byggt á hermun.

\textbf{Lausn: } Keyrum forritið fyrir verkefni 2 og fáum eftirfarandi:

\begin{figure}[H]
\centering
\includegraphics[scale=0.8]{poisproblemrun.png}
\end{figure}

Hér sést að fræðilegt vænt gildi af fjölda atburða á 78 tímaeiningum er 4.836 meðan hermigildið reynist vera 4.809 svo skekkjan er um 0,027 í þessu tilfelli.

\medskip

\textbf{2.2. } Hvert er staðalfrávik fjölda atburða sem á sér stað á bilinu [0;78]? Notið sömu hermun og áðan. Hvernig ber fræðilega staðalfrávikinu saman við reiknaða staðalfrávikið sem er byggt á hermun?

\medskip

\textbf{Lausn: } Við skoðum sömu hermun og áðan og fáum að hermistaðalfrávik reiknast sem 2.200733925 meðan fræðilegt staðalfrávik reiknast sem 2.19909072211 og munurinn er þá um 0.00164.

\medskip

\textbf{2.3. } Reiknið líkurnar á að fjöldi atburða sé n, það er, reiknið P(Nt = n), fyrir n = 0, 1, ..., 13, samkvæmt
reglum um Poissonferli. Notið dpois í R eða poisspdf í Matlab ykkur til aðstoðar hér.

\medskip

\textbf{2.4. } Reiknið hlutfallslega tíðni þess að á fjöldi atburða sé Nt = n, það er, finnið fjölda ítrana þar sem
fjöldi atburða er n og deilið með B = 4000 fyrir n = 0, 1, ..., 13. Berið saman við fræðilegu líkurnar
samkvæmt reglum um Poissonferli. Setjið fram töflu með þessum gildum, það er, n = 0, 1, ..., 13,
hlutfallslegri tíðni og fræðilegum líkum.

\medskip

\textbf{Lausn: } Leysum þessa tvo liði saman. Tökum upplýsingarnar úr mynd að ofan og setjum í töflu til að auka læsileika:

\begin{table}[H]
\centering
\caption{Líkur á atburðum}
\label{my-label}
\begin{tabular}{lll}
\textbf{Fjöldi atburða} & \textbf{Hermigildi} & \textbf{Fræðilegt gildi} \\
0                       & 0.0079              & 0.0098                   \\
1                       & 0.0384              & 0.0368                   \\
2                       & 0.0928              & 0.0948                   \\
3                       & 0.1496              & 0.1532                   \\
4                       & 0.1809              & 0.1762                   \\
5                       & 0.175               & 0.1865                   \\
6                       & 0.141               & 0.133                    \\
7                       & 0.0974              & 0.0908                   \\
8                       & 0.0589              & 0.0608                   \\
9                       & 0.0316              & 0.033                    \\
10                      & 0.0153              & 0.0148                   \\
11                      & 0.0067              & 0.0065                   \\
12                      & 0.0027              & 0.0025                   \\
13                      & 0.001               & 0.0008                  
\end{tabular}
\end{table}

Þessi tafla virðist vera í nokkuð góðu lagi þó svo að smá sveiflur sjáist í gildunum.

\medskip

\textbf{2.5.} Teiknið sex ferla viðburðastreymis á bilinu [0, 78]. Byrjið á að teikna sex línur fyrir ofan hvor aðra á
sömu mynd. Hver lína sýnir eina hermun atburða á bilinu [0, 78]. Á hverja línu eru settir krossar þar sem
atburðir áttu sér stað.

\medskip

\textbf{Lausn: } Setjum inn í forritið að við viljum fá 5 gröf til að fá eftirfarandi niðurstöðu:

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{poisgraph.png}
\end{figure}

\newpage

\textbf{Kóði } Hér á eftir fylgir kóðinn sem var notaður í úrlausn verkefnanna. Skráin logProblem.R var notuð til að leysa fyrra verkefnið meðan poisProblem.R var notuð til að leysa það seinna.

\medskip

Hérna er mew meðalgildið á lografallinu, stdev er staðalfrávikið á því, iterations eru hversu margar ítranir skal framkvæma, days tímaeiningafjöldinn og numgraphs fjöldi grafa sem fallið skilar af sér.

\lstinputlisting{logProblem.r}

\newpage

Í þessu falli er iterations ítranafjöldi, tíminn segir til um lengd hvers ferils, c er tíðni Poissonferilsins sem verið er að herma og graphNum er fjöldi þeirra grafa sem fallið á að skila af sér.

\lstinputlisting{poisProblem.r}

\end{document}